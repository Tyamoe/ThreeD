precision mediump float;

varying vec3 fragTexCoord;
varying float vDistance;
varying vec2 u_FogDist;

uniform samplerCube sampler;
uniform vec4 tcolor;

void main()
{
	const float FogDensity = 0.02;
	vec4 u_FogColor = vec4(0.323, 0.323, 0.423, 1.0);

	//float fogFactor = clamp((u_FogDist.y - vDistance) / (u_FogDist.y - u_FogDist.x), 0.0, 1.0);
	float fogFactor = clamp((1.0 /exp(vDistance * FogDensity)), 0.0, 1.0);
	
	vec4 color = mix(u_FogColor, textureCube(sampler, fragTexCoord) * tcolor, fogFactor);
	
	//gl_FragColor = color;

	gl_FragColor = textureCube(sampler, fragTexCoord) * tcolor;
}